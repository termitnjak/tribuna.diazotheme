<?xml version="1.0" encoding="UTF-8"?>
<rules
    xmlns="http://namespaces.plone.org/diazo"
    xmlns:css="http://namespaces.plone.org/diazo/css"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:xi="http://www.w3.org/2001/XInclude">

    <!-- <drop css:theme-children="#header" /> -->

    <!-- <after theme-children="/html/head" content="/html/head/script" />
    <after theme-children="/html/head" content="/html/head/link | /html/head/style" />
 -->


    <merge attributes="class" css:content="#homepage-div" css:theme="#right-column" />

    <theme href="tribuna_entrypage.html" css:if-content="#change-form"/>
    <!-- <drop css:content="#change-form" /> -->
    <rules css:if-content="#change-form">
        <merge attributes="style" css:content="#background-placeholder" css:theme="body" />
        <replace css:content-children="#picture-change" css:theme-children="#collapseOne"/>
        <replace css:content-children="#text-change" css:theme-children="#collapseTwo"/>
        <replace css:content-children="#old-pages" css:theme-children="#collapseThree"/>
        <rules css:if-content="#text-container">
            <after css:theme="#entrypage-form-container" css:content="#text-container" />
        </rules>
    </rules>


    <theme href="tribuna_base.html" if-path="@@home-page home-page"/>
    <rules if-path="@@home-page home-page">
        <!-- <replace css:content=".portlet.portletSidebar" css:theme="#sidebar-portlet" /> -->
        <!-- <drop css:theme=".navbar.navbar-fixed-top" /> -->
        <before css:theme="#center-column-content" css:if-content="#edit-bar">
          <div id="action-bar">
              <ul class="nav nav-tabs">
              <xsl:for-each css:select="#content-views > li">
                  <xi:include href="navigation-rules.xml"/>
              </xsl:for-each>
              <xsl:for-each css:select="#contentActionMenus > li">
                  <li class="dropdown pull-right" data-dropdown="dropdown">
                      <a class="dropdown-toggle" href="#"><xsl:attribute name="href">
                              <xsl:value-of select="dl/dt/a/@href"/>
                          </xsl:attribute>
                          <xsl:copy-of select="dl/dt/a/span"/>
                          <b class="caret"></b>
                      </a>
                      <ul class="dropdown-menu" style="min-width:150px;">
                          <xsl:for-each css:select=".actionMenuContent > ul > li">
                              <xsl:copy-of select="current()"/>
                          </xsl:for-each>
                      </ul>
                  </li>
              </xsl:for-each>
              </ul>
          </div>
        </before>

        <replace css:theme-children="#tags-list">
            <xsl:for-each css:select="#formfield-form-widgets-tags .option">
                <xsl:element name="li">
                    <xsl:attribute name="id"> <xsl:copy-of select="label/span/text()"/></xsl:attribute>
                    <xsl:choose>
                      <xsl:when test="input/@checked='checked'">
                        <xsl:attribute name="class">selected</xsl:attribute>
                        <a href="#">-</a>
                      </xsl:when>
                      <xsl:otherwise>
                        <a href="#">+</a>
                      </xsl:otherwise>
                    </xsl:choose>
                     <span><a href="#"><xsl:copy-of select="label/span/text()"/></a></span>
                 </xsl:element>
            </xsl:for-each>
        </replace>
        <replace css:theme-children="#types-list">
            <xsl:for-each css:select="#formfield-form-widgets-content_filters .option">
                <xsl:element name="input">
                  <xsl:attribute name="type">checkbox</xsl:attribute>
                  <xsl:attribute name="name"><xsl:value-of select="label/span/text()" /></xsl:attribute>
                  <xsl:attribute name="id"><xsl:value-of select="input/@value" /></xsl:attribute>
                  <xsl:if test="input/@checked='checked'">
                    <xsl:attribute name="checked">checked</xsl:attribute>
                  </xsl:if>
                </xsl:element>
                <span class="red"><xsl:copy-of select="label/span/text()"/></span>
                <br />
            </xsl:for-each>
        </replace>
        <replace css:theme-children="#all-tags-list">
            <xsl:for-each css:select="#formfield-form-widgets-all_tags .option">
                <xsl:element name="li">
                    <xsl:attribute name="id"> <xsl:copy-of select="label/span/text()"/></xsl:attribute>
                    <xsl:choose>
                      <xsl:when test="input/@checked='checked'">
                        <xsl:attribute name="class">selected</xsl:attribute>
                        <a href="#">-</a>
                      </xsl:when>
                      <xsl:otherwise>
                        <a href="#">+</a>
                      </xsl:otherwise>
                    </xsl:choose>
                     <span><a href="#"><xsl:copy-of select="label/span/text()"/></a></span>
                 </xsl:element>
            </xsl:for-each>
        </replace>
        <replace css:theme-children="#selected-tags-list">
            <xsl:for-each css:select="#formfield-form-widgets-all_tags .option">
                <xsl:if test="input/@checked='checked'">
                  <xsl:element name="li">
                      <xsl:attribute name="id"> <xsl:copy-of select="label/span/text()"/></xsl:attribute>
                      <xsl:attribute name="class">selected</xsl:attribute>
                          <a href="#">-</a>
                          <span><a href="#"><xsl:copy-of select="label/span/text()"/></a></span>
                  </xsl:element>
                </xsl:if>
            </xsl:for-each>
        </replace>

        <replace css:content="#form-buttons-text">
            <input id="form-buttons-text" name="form.buttons.text" class="submit-widget button-field" value="Text" type="image" src="++theme++tribuna.diazotheme/img/sidebar-text.png" />
        </replace>

        <replace css:content="#form-buttons-drag">
          <input id="form-buttons-drag" name="form.buttons.drag" class="submit-widget button-field" value="Drag" type="image" src="++theme++tribuna.diazotheme/img/sidebar-drag.png" />
        </replace>

        <after css:theme="#types-list" css:content="#form" />

        <!-- <rules css:if-content="#tag-description-div"> -->
          <rules css:if-content=".articles_intersection">
              <after css:theme=".portlet-header" css:content="#formfield-form-widgets-sort_on" />
              <replace css:content-children=".articles_intersection" css:theme-children="#intersection-articles"/>
              <replace css:content-children=".articles_union" css:theme-children="#union-articles"/>
              <replace css:content-children="#tag-description-div" css:theme-children="#content" />
          </rules>
          <rules css:if-not-content=".articles_intersection">
            <replace css:content-children="#tag-description-div" css:theme-children="#content" css:if-content="#tag-description-div" />
            <replace css:content="#homepage-div" css:theme-children="#right-column-content"/>
          </rules>
        </rules>

        <drop css:theme="#center-column-content" css:if-not-content="#tag-description-div" />
        <drop css:theme="#articles-header" css:if-not-content="#tag-description-div" />

        <!-- <rules css:if-not-content="#tag-description-div">
          <rules css:if-content=".articles_intersection" >
            <drop css:theme="#right-column" />
            <before css:theme="#content" css:content="#formfield-form-widgets-sort_on" />
            <replace css:content-children=".articles_intersection" css:theme-children="#content"/>
            <after css:theme=".articles_intersection" css:content=".articles_union"/>
          </rules>
          <rules css:if-not-content=".articles_intersection">
              <rules css:if-not-content="#tag-description-div" >
                  <drop css:theme="#right-column" />
                  <replace css:content="#homepage-div" css:theme="#content"/>
              </rules>
          </rules>
        </rules>
    </rules> -->
    <theme href="tribuna_results.html" if-path="@@main-page"/>
    <rules if-path="@@main-page" >
      <before css:theme="#head" content="/html/body/script" />
      <after css:theme="#container" css:content="#gallery-start" />
      <replace css:theme="#container" css:content="#gallery" />
    </rules>
    <before css:theme="head" content="/html/head/script" />
    <before css:theme="head" content="/html/head/link" />

</rules>
